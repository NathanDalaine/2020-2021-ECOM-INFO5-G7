{"remainingRequest":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\thread-loader\\dist\\cjs.js??ref--9-2!C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\ts-loader\\index.js??ref--9-3!C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\eslint-loader\\dist\\cjs.js!C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\src\\main\\webapp\\app\\core\\auth\\auth-jwt.service.ts","dependencies":[{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\src\\main\\webapp\\app\\core\\auth\\auth-jwt.service.ts","mtime":1571756641536},{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\angular2-template-loader\\index.js","mtime":1486570058000},{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\eslint-loader\\dist\\cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tICJ0c2xpYiI7DQp2YXIgX2EsIF9iLCBfYzsNCmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJzsNCmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7DQppbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7DQovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzDQppbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7DQppbXBvcnQgeyBMb2NhbFN0b3JhZ2VTZXJ2aWNlLCBTZXNzaW9uU3RvcmFnZVNlcnZpY2UgfSBmcm9tICduZ3gtd2Vic3RvcmFnZSc7DQppbXBvcnQgeyBTRVJWRVJfQVBJX1VSTCB9IGZyb20gJ2FwcC9hcHAuY29uc3RhbnRzJzsNCmxldCBBdXRoU2VydmVyUHJvdmlkZXIgPSBjbGFzcyBBdXRoU2VydmVyUHJvdmlkZXIgew0KICAgIGNvbnN0cnVjdG9yKGh0dHAsICRsb2NhbFN0b3JhZ2UsICRzZXNzaW9uU3RvcmFnZSkgew0KICAgICAgICB0aGlzLmh0dHAgPSBodHRwOw0KICAgICAgICB0aGlzLiRsb2NhbFN0b3JhZ2UgPSAkbG9jYWxTdG9yYWdlOw0KICAgICAgICB0aGlzLiRzZXNzaW9uU3RvcmFnZSA9ICRzZXNzaW9uU3RvcmFnZTsNCiAgICB9DQogICAgZ2V0VG9rZW4oKSB7DQogICAgICAgIHJldHVybiB0aGlzLiRsb2NhbFN0b3JhZ2UucmV0cmlldmUoJ2F1dGhlbnRpY2F0aW9uVG9rZW4nKSB8fCB0aGlzLiRzZXNzaW9uU3RvcmFnZS5yZXRyaWV2ZSgnYXV0aGVudGljYXRpb25Ub2tlbicpOw0KICAgIH0NCiAgICBsb2dpbihjcmVkZW50aWFscykgew0KICAgICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICAgICAgdXNlcm5hbWU6IGNyZWRlbnRpYWxzLnVzZXJuYW1lLA0KICAgICAgICAgICAgcGFzc3dvcmQ6IGNyZWRlbnRpYWxzLnBhc3N3b3JkLA0KICAgICAgICAgICAgcmVtZW1iZXJNZTogY3JlZGVudGlhbHMucmVtZW1iZXJNZQ0KICAgICAgICB9Ow0KICAgICAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVTdWNjZXNzKHJlc3ApIHsNCiAgICAgICAgICAgIGNvbnN0IGJlYXJlclRva2VuID0gcmVzcC5oZWFkZXJzLmdldCgnQXV0aG9yaXphdGlvbicpOw0KICAgICAgICAgICAgaWYgKGJlYXJlclRva2VuICYmIGJlYXJlclRva2VuLnNsaWNlKDAsIDcpID09PSAnQmVhcmVyICcpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBqd3QgPSBiZWFyZXJUb2tlbi5zbGljZSg3LCBiZWFyZXJUb2tlbi5sZW5ndGgpOw0KICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVBdXRoZW50aWNhdGlvblRva2VuKGp3dCwgY3JlZGVudGlhbHMucmVtZW1iZXJNZSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGp3dDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QoU0VSVkVSX0FQSV9VUkwgKyAnYXBpL2F1dGhlbnRpY2F0ZScsIGRhdGEsIHsgb2JzZXJ2ZTogJ3Jlc3BvbnNlJyB9KS5waXBlKG1hcChhdXRoZW50aWNhdGVTdWNjZXNzLmJpbmQodGhpcykpKTsNCiAgICB9DQogICAgbG9naW5XaXRoVG9rZW4oand0LCByZW1lbWJlck1lKSB7DQogICAgICAgIGlmIChqd3QpIHsNCiAgICAgICAgICAgIHRoaXMuc3RvcmVBdXRoZW50aWNhdGlvblRva2VuKGp3dCwgcmVtZW1iZXJNZSk7DQogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGp3dCk7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ2F1dGgtand0LXNlcnZpY2UgUHJvbWlzZSByZWplY3QnKTsgLy8gUHV0IGFwcHJvcHJpYXRlIGVycm9yIG1lc3NhZ2UgaGVyZQ0KICAgICAgICB9DQogICAgfQ0KICAgIHN0b3JlQXV0aGVudGljYXRpb25Ub2tlbihqd3QsIHJlbWVtYmVyTWUpIHsNCiAgICAgICAgaWYgKHJlbWVtYmVyTWUpIHsNCiAgICAgICAgICAgIHRoaXMuJGxvY2FsU3RvcmFnZS5zdG9yZSgnYXV0aGVudGljYXRpb25Ub2tlbicsIGp3dCk7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRzZXNzaW9uU3RvcmFnZS5zdG9yZSgnYXV0aGVudGljYXRpb25Ub2tlbicsIGp3dCk7DQogICAgICAgIH0NCiAgICB9DQogICAgbG9nb3V0KCkgew0KICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUob2JzZXJ2ZXIgPT4gew0KICAgICAgICAgICAgdGhpcy4kbG9jYWxTdG9yYWdlLmNsZWFyKCdhdXRoZW50aWNhdGlvblRva2VuJyk7DQogICAgICAgICAgICB0aGlzLiRzZXNzaW9uU3RvcmFnZS5jbGVhcignYXV0aGVudGljYXRpb25Ub2tlbicpOw0KICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTsNCiAgICAgICAgfSk7DQogICAgfQ0KfTsNCkF1dGhTZXJ2ZXJQcm92aWRlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbDQogICAgSW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KSwNCiAgICB0c2xpYl8xLl9fbWV0YWRhdGEoImRlc2lnbjpwYXJhbXR5cGVzIiwgW3R5cGVvZiAoX2EgPSB0eXBlb2YgSHR0cENsaWVudCAhPT0gInVuZGVmaW5lZCIgJiYgSHR0cENsaWVudCkgPT09ICJmdW5jdGlvbiIgPyBfYSA6IE9iamVjdCwgdHlwZW9mIChfYiA9IHR5cGVvZiBMb2NhbFN0b3JhZ2VTZXJ2aWNlICE9PSAidW5kZWZpbmVkIiAmJiBMb2NhbFN0b3JhZ2VTZXJ2aWNlKSA9PT0gImZ1bmN0aW9uIiA/IF9iIDogT2JqZWN0LCB0eXBlb2YgKF9jID0gdHlwZW9mIFNlc3Npb25TdG9yYWdlU2VydmljZSAhPT0gInVuZGVmaW5lZCIgJiYgU2Vzc2lvblN0b3JhZ2VTZXJ2aWNlKSA9PT0gImZ1bmN0aW9uIiA/IF9jIDogT2JqZWN0XSkNCl0sIEF1dGhTZXJ2ZXJQcm92aWRlcik7DQpleHBvcnQgeyBBdXRoU2VydmVyUHJvdmlkZXIgfTsNCg=="},{"version":3,"file":"C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\src\\main\\webapp\\app\\core\\auth\\auth-jwt.service.ts","sourceRoot":"","sources":["C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\node_modules\\eslint-loader\\dist\\cjs.js!C:\\Users\\baptiste\\Documents\\workspace\\2019-2020-ecom-info5-root\\app\\src\\main\\webapp\\app\\core\\auth\\auth-jwt.service.ts"],"names":[],"mappings":";;AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAC3C,OAAO,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAC;AAClD,OAAO,EAAE,UAAU,EAAE,MAAM,MAAM,CAAC;AAClC,6DAA6D;AAC7D,OAAO,EAAE,GAAG,EAAE,MAAM,gBAAgB,CAAC;AACrC,OAAO,EAAE,mBAAmB,EAAE,qBAAqB,EAAE,MAAM,gBAAgB,CAAC;AAE5E,OAAO,EAAE,cAAc,EAAE,MAAM,mBAAmB,CAAC;AAGnD,IAAa,kBAAkB,GAA/B,MAAa,kBAAkB;IAC7B,YAAoB,IAAgB,EAAU,aAAkC,EAAU,eAAsC;QAA5G,SAAI,GAAJ,IAAI,CAAY;QAAU,kBAAa,GAAb,aAAa,CAAqB;QAAU,oBAAe,GAAf,eAAe,CAAuB;IAAG,CAAC;IAEpI,QAAQ;QACN,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,qBAAqB,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,qBAAqB,CAAC,CAAC;IACpH,CAAC;IAED,KAAK,CAAC,WAAW;QACf,MAAM,IAAI,GAAG;YACX,QAAQ,EAAE,WAAW,CAAC,QAAQ;YAC9B,QAAQ,EAAE,WAAW,CAAC,QAAQ;YAC9B,UAAU,EAAE,WAAW,CAAC,UAAU;SACnC,CAAC;QAEF,SAAS,mBAAmB,CAAC,IAAI;YAC/B,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;YACtD,IAAI,WAAW,IAAI,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,SAAS,EAAE;gBACxD,MAAM,GAAG,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBACrD,IAAI,CAAC,wBAAwB,CAAC,GAAG,EAAE,WAAW,CAAC,UAAU,CAAC,CAAC;gBAC3D,OAAO,GAAG,CAAC;aACZ;QACH,CAAC;QAED,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,GAAG,kBAAkB,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,UAAU,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACtI,CAAC;IAED,cAAc,CAAC,GAAG,EAAE,UAAU;QAC5B,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,wBAAwB,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;YAC/C,OAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;SAC7B;aAAM;YACL,OAAO,OAAO,CAAC,MAAM,CAAC,iCAAiC,CAAC,CAAC,CAAC,qCAAqC;SAChG;IACH,CAAC;IAED,wBAAwB,CAAC,GAAG,EAAE,UAAU;QACtC,IAAI,UAAU,EAAE;YACd,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,qBAAqB,EAAE,GAAG,CAAC,CAAC;SACtD;aAAM;YACL,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,qBAAqB,EAAE,GAAG,CAAC,CAAC;SACxD;IACH,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,UAAU,CAAC,QAAQ,CAAC,EAAE;YAC/B,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;YAChD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;YAClD,QAAQ,CAAC,QAAQ,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC;IACL,CAAC;CACF,CAAA;AAlDY,kBAAkB;IAD9B,UAAU,CAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAC;iEAEP,UAAU,oBAAV,UAAU,oDAAyB,mBAAmB,oBAAnB,mBAAmB,oDAA2B,qBAAqB,oBAArB,qBAAqB;GADrH,kBAAkB,CAkD9B;SAlDY,kBAAkB","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { map } from 'rxjs/operators';\r\nimport { LocalStorageService, SessionStorageService } from 'ngx-webstorage';\r\n\r\nimport { SERVER_API_URL } from 'app/app.constants';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class AuthServerProvider {\r\n  constructor(private http: HttpClient, private $localStorage: LocalStorageService, private $sessionStorage: SessionStorageService) {}\r\n\r\n  getToken() {\r\n    return this.$localStorage.retrieve('authenticationToken') || this.$sessionStorage.retrieve('authenticationToken');\r\n  }\r\n\r\n  login(credentials): Observable<any> {\r\n    const data = {\r\n      username: credentials.username,\r\n      password: credentials.password,\r\n      rememberMe: credentials.rememberMe\r\n    };\r\n\r\n    function authenticateSuccess(resp) {\r\n      const bearerToken = resp.headers.get('Authorization');\r\n      if (bearerToken && bearerToken.slice(0, 7) === 'Bearer ') {\r\n        const jwt = bearerToken.slice(7, bearerToken.length);\r\n        this.storeAuthenticationToken(jwt, credentials.rememberMe);\r\n        return jwt;\r\n      }\r\n    }\r\n\r\n    return this.http.post(SERVER_API_URL + 'api/authenticate', data, { observe: 'response' }).pipe(map(authenticateSuccess.bind(this)));\r\n  }\r\n\r\n  loginWithToken(jwt, rememberMe) {\r\n    if (jwt) {\r\n      this.storeAuthenticationToken(jwt, rememberMe);\r\n      return Promise.resolve(jwt);\r\n    } else {\r\n      return Promise.reject('auth-jwt-service Promise reject'); // Put appropriate error message here\r\n    }\r\n  }\r\n\r\n  storeAuthenticationToken(jwt, rememberMe) {\r\n    if (rememberMe) {\r\n      this.$localStorage.store('authenticationToken', jwt);\r\n    } else {\r\n      this.$sessionStorage.store('authenticationToken', jwt);\r\n    }\r\n  }\r\n\r\n  logout(): Observable<any> {\r\n    return new Observable(observer => {\r\n      this.$localStorage.clear('authenticationToken');\r\n      this.$sessionStorage.clear('authenticationToken');\r\n      observer.complete();\r\n    });\r\n  }\r\n}\r\n"]}]}